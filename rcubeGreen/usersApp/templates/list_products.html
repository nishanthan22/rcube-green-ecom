{% extends "admin_home.html" %}

{% block title %}Product List{% endblock %}

{% block content %}
  <div class="container" style="display: flex; justify-content: center; align-items: center; flex-direction: column; min-height: 60vh;">
    <h2 class="h2 section-title">Products</h2>
    <div class="button-group" style="margin-bottom: 20px;">
    <table style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr>
          <th class="text-align-center" style="padding: 10px; border-bottom: 1px solid var(--cultured);">Product Image</th>
          <th class="text-align-center" style="padding: 10px; border-bottom: 1px solid var(--cultured);">Product Name</th>
          <th class="text-align-center" style="padding: 10px; border-bottom: 1px solid var(--cultured);">Category</th>
          <th class="text-align-center" style="padding: 10px; border-bottom: 1px solid var(--cultured);">Price in CAD</th>
          <th class="text-align-center" style="padding: 10px; border-bottom: 1px solid var(--cultured);">Edit</th>
          <th class="text-align-center" style="padding: 10px; border-bottom: 1px solid var(--cultured);">Delete</th>
        </tr>

      </thead>
      <tbody>
        {% for product in products %}
          <tr>
            <td style="padding: 10px; text-align: left;">
              {% if product.image %}
                <img src="{{ product.image.url }}" alt="{{ product.name }}" style="height: 100px;">
              {% else %}
                No image
              {% endif %}
            </td>
            <td style="padding: 10px; text-align: left;">{{ product.name }}</td>
            <td style="padding: 10px; text-align: left;">{{ product.category.name }}</td>
            <td style="padding: 10px; text-align: center;">{{ product.price }}</td>
            <td style="padding: 20px; text-align: left;">
              <a href="{% url 'edit_product' product.id %}">
                <button type="button" class="btn btn-primary">Edit</button>
              </a>
            </td>
            <td style="padding: 10px; text-align: center;">
              <form id="deleteForm{{ product.id }}" method="post" action="{% url 'delete_product' product.id %}">
                {% csrf_token %}
                <button type="button" class="btn btn-secondary" onclick="confirmDelete('{{ product.id }}')">Delete</button>
              </form>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <script>
    function confirmDelete(productId) {
      if (confirm("Are you sure you want to delete this product?")) {
        document.getElementById("deleteForm" + productId).submit();
      } else {
        // Handle cancel action - For example, redirect to product list page
        window.location.href = "{% url 'list_products' %}";
      }
    }
  </script>
{% endblock %}
